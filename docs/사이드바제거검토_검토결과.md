# 사이드바 제거 검토 문서 검토 결과

## 검토 개요

**검토 대상**: `docs/사이드바제거검토.md`  
**기준 문서**: `docs/사이드바_제거_및_상단메뉴_전환_명세서.md`  
**검토 일시**: 2026-01-26

---

## ✅ 검토 문서의 강점

### 1. 실무적 리스크 식별
- 공개 페이지 판별 누락 가능성 지적
- 컨텍스트 확보 전략 제시
- 성능/안정성 관점 강조
- 점진적 전환 전략 제안

### 2. 명확한 DoD 제시
- 완료 조건을 구체적으로 정의
- 테스트 체크리스트 포함
- 레이아웃 잔재 제거 기준 명확화

### 3. 명세서와의 일치성
- 명세서의 핵심 내용을 정확히 반영
- Phase별 구현 가이드가 명세서 구조와 일치

---

## 🔍 발견된 문제점 및 보완 사항

### 1. 공개 페이지 판별 로직 - 실제 코드와의 차이

**검토 문서의 지적**:
> 예시 코드의 isPublicPage 조건은 `/`, `/login`, `/signup`, `/webinar/*(console/registrants/stats 제외)` 정도만 포함되어 있음 → **`/privacy`, `/unsubscribe`, `/event/*` 누락 가능성**이 큼.

**실제 코드 확인 결과**:
```typescript
// LayoutWrapper.tsx (현재 코드)
const isPublicPage = pathname === '/' || 
  pathname.startsWith('/login') || 
  pathname.startsWith('/signup') || 
  pathname.startsWith('/privacy')

const isSurveyPublicPage = pathname.startsWith('/event/')
const isUnsubscribePage = pathname.startsWith('/unsubscribe')
```

**검토 의견**:
- ✅ 실제 코드는 이미 `/privacy`, `/unsubscribe`, `/event/*`를 처리하고 있음
- ⚠️ 하지만 명세서의 예시 코드는 간소화된 버전으로, 실제 구현 시 **명세서의 전체 목록을 반영**해야 함
- ✅ 검토 문서의 지적은 타당하며, **명세서 예시 코드를 실제 구현 시 보완**해야 함

**권장 사항**:
```typescript
// TopNav 구현 시 권장하는 공개 페이지 판별 로직
const isPublicPage = 
  pathname === '/' || 
  pathname.startsWith('/login') || 
  pathname.startsWith('/signup') || 
  pathname.startsWith('/privacy') ||
  pathname.startsWith('/unsubscribe') ||
  pathname.startsWith('/event/') ||
  (pathname.startsWith('/webinar/') && 
   !pathname.includes('/console') && 
   !pathname.includes('/registrants') && 
   !pathname.includes('/stats'))
```

---

### 2. 웨비나 관리 페이지 판별 로직의 복잡성

**검토 문서의 언급**:
> 웨비나 관리 페이지는 `/webinar/[id]/console|registrants|stats`로 **clientId가 URL에 직접 없음** → "← 클라이언트로 돌아가기" 링크를 만들려면 **webinar→client 매핑 데이터가 필요**하다.

**실제 코드 확인 결과**:
```typescript
// LayoutWrapper.tsx
const isConsolePage = pathname.endsWith('/console') || decodedPathname.endsWith('/console')
const isRegistrantsPage = pathname.endsWith('/registrants') || decodedPathname.endsWith('/registrants')
const isStatsPage = pathname.endsWith('/stats') || decodedPathname.endsWith('/stats')
const isAdminWebinarPage = (isConsolePage || isRegistrantsPage || isStatsPage) && 
                           (pathname.startsWith('/webinar/') || decodedPathname.startsWith('/webinar/'))
```

**검토 의견**:
- ✅ 실제 코드는 URL 인코딩까지 고려한 안전한 판별 로직 사용
- ⚠️ 검토 문서에서 언급한 "webinar→client 매핑" 문제는 실제로 존재하며, 현재 `ConsoleView.tsx`에서도 하드코딩된 링크 사용:
  ```typescript
  <Link href={`/client/${webinar.client_id}/dashboard`}>
    ← 메인 대시보드로
  </Link>
  ```
- ✅ 검토 문서의 지적대로, **서버에서 webinar 데이터와 함께 client_id를 주입**하는 방식이 안전함

**권장 사항**:
- TopNav/WebinarHeader 컴포넌트에서 webinar 데이터를 props로 받아 client_id 활용
- 또는 레이아웃 레벨에서 서버 컴포넌트로 webinar 정보 조회 후 클라이언트 컴포넌트에 전달

---

### 3. 레이아웃 잔재 제거 - 실제 코드 확인

**검토 문서의 지적**:
> 과거 개선 이력에서 main 폭을 `calc(100vw - sidebarWidth)`로 계산하던 부분이 있었음 → **사이드바 제거 시 100% 폭 기준으로 재정렬** 필요.

**실제 코드 확인 결과**:
```typescript
// LayoutWrapper.tsx (현재)
<main 
  className="min-w-0 pb-[calc(4rem+env(safe-area-inset-bottom))] lg:pb-0 transition-all duration-300 min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 ml-0 lg:ml-64 w-full lg:w-[calc(100vw-16rem)] lg:max-w-[calc(100vw-16rem)]"
>
```

**검토 의견**:
- ✅ 검토 문서의 지적이 정확함
- ⚠️ 실제 코드에 `lg:ml-64` (사이드바 너비만큼 왼쪽 마진)와 `lg:w-[calc(100vw-16rem)]` (사이드바 너비 제외한 폭 계산)이 존재
- ✅ 사이드바 제거 시 이 부분을 **반드시 제거**해야 함

**권장 수정 사항**:
```typescript
// TopNav 전환 후
<main className="pt-16 min-h-screen w-full">
  {children}
</main>
```

---

### 4. 모바일 네비게이션 패턴 - z-index 충돌 가능성

**검토 문서의 언급**:
> 드로어가 기존 콘솔 UI(예: 모달, 바텀시트, 채팅 입력 등)와 **z-index/포커스 충돌**이 없는지 기준 수립 필요.

**검토 의견**:
- ✅ 검토 문서의 지적이 타당함
- ⚠️ 실제 코드에서 사이드바는 `z-50` 사용, 모바일 하단 메뉴도 `z-50` 사용
- ⚠️ 웨비나 콘솔의 모달/채팅 등도 z-index 사용 가능성 있음
- ✅ TopNav는 `z-50` 이상, 모바일 드로어는 `z-40` 정도로 설정하여 충돌 방지 필요

**권장 사항**:
- TopNav: `z-50` (현재 사이드바와 동일)
- 모바일 드로어: `z-40` (TopNav보다 낮게)
- 콘솔 모달/채팅: `z-30` 이하로 유지

---

### 5. 점진적 전환 전략 - Feature Flag 구현 방식

**검토 문서의 제안**:
> 운영 중(실제 고객/라이브)이 있다면 **점진적(Feature Flag) 전환을 기본**으로 잡는 게 리스크가 낮다.

**검토 의견**:
- ✅ 점진적 전환 전략이 타당함
- ⚠️ 하지만 검토 문서에서 Feature Flag의 **구체적인 구현 방식**이 명시되지 않음
- ✅ 환경 변수 기반 플래그 제안:
  ```typescript
  const USE_TOP_NAV = process.env.NEXT_PUBLIC_USE_TOP_NAV === 'true'
  ```

**권장 사항**:
- Feature Flag는 환경 변수 또는 사용자 설정으로 관리
- 초기에는 사이드바와 TopNav 병행 표시 (토글 가능)
- 안정화 후 사이드바 완전 제거

---

## 📋 추가 검토 사항

### 1. 슈퍼 관리자 페이지 처리

**명세서 언급**:
> `app/(super)/super/_components/SuperSidebar.tsx`: 슈퍼 관리자 전용 사이드바

**검토 의견**:
- ⚠️ 검토 문서에서 슈퍼 관리자 페이지의 SuperSidebar 제거에 대한 언급이 있으나, **구체적인 전환 계획**이 부족
- ✅ 슈퍼 관리자도 TopNav로 전환하되, 메뉴 구조만 다르게 구성

**권장 사항**:
- `app/(super)/super/layout.tsx`에서 SuperSidebar 제거
- TopNav에서 역할 감지 후 슈퍼 관리자 메뉴 표시

---

### 2. 웨비나 관리 페이지 서브 메뉴 높이 계산

**검토 문서의 지적**:
> 이 헤더는 운영콘솔 UI의 세로 공간을 추가로 먹음 → 콘솔 화면(탭, 채팅/질문 영역) 레이아웃이 깨지지 않게 "높이 계산" 기준을 명확히 해야 함.

**검토 의견**:
- ✅ 검토 문서의 지적이 정확함
- ⚠️ 현재 콘솔 페이지는 자체 헤더를 가지고 있음 (`ConsoleView.tsx`)
- ✅ TopNav(64px) + WebinarHeader(추정 80px) = 총 144px 정도의 상단 공간 필요
- ✅ 콘텐츠 영역에 `pt-[144px]` 또는 동적 계산 필요

**권장 사항**:
```typescript
// 웨비나 관리 페이지 레이아웃
<main className="pt-[144px] min-h-screen">
  {/* TopNav(64px) + WebinarHeader(80px) = 144px */}
  {children}
</main>
```

---

### 3. 접근성 요구사항 구체화

**검토 문서의 언급**:
> 명세에 접근성 요구가 명시되어 있으므로(키보드/스크린리더/ARIA), 모바일 드로어는 최소한:
> - 열림/닫힘 상태가 스크린리더에 전달
> - 키보드 포커스 이동이 합리적

**검토 의견**:
- ✅ 접근성 요구사항 언급은 있으나, **구체적인 구현 가이드**가 부족
- ✅ ARIA 속성 예시 추가 권장

**권장 사항**:
```typescript
// 모바일 드로어 접근성 예시
<nav 
  aria-label="메인 네비게이션"
  aria-hidden={!mobileMenuOpen}
  role="dialog"
  aria-modal="true"
>
  <button 
    aria-label="메뉴 닫기"
    aria-expanded={mobileMenuOpen}
  >
    닫기
  </button>
</nav>
```

---

## ✅ 검토 문서의 완성도 평가

### 잘 된 부분 (90점)
1. ✅ 명세서의 핵심 내용을 정확히 반영
2. ✅ 실무적 리스크를 잘 식별
3. ✅ DoD를 구체적으로 정의
4. ✅ Phase별 구현 가이드 제공

### 보완이 필요한 부분
1. ⚠️ 실제 코드베이스와의 차이점 명시 부족
2. ⚠️ Feature Flag 구현 방식 구체화 필요
3. ⚠️ 접근성 구현 가이드 보강 필요
4. ⚠️ 슈퍼 관리자 페이지 전환 계획 보강 필요

---

## 🎯 최종 권장 사항

### 1. 검토 문서 보완
- 실제 코드베이스 확인 결과를 반영한 보완 버전 작성
- Feature Flag 구현 예시 코드 추가
- 접근성 구현 가이드 보강

### 2. 구현 전 체크리스트 추가
- [ ] LayoutWrapper.tsx의 공개 페이지 판별 로직을 명세서 목록과 1:1 대조
- [ ] main 태그의 사이드바 관련 클래스(`ml-64`, `calc(100vw-16rem)`) 제거 확인
- [ ] SuperSidebar 제거 계획 수립
- [ ] 웨비나 관리 페이지의 기존 헤더와 WebinarHeader 통합 계획 수립
- [ ] z-index 충돌 방지 전략 수립

### 3. 테스트 시나리오 보강
검토 문서 마지막에 언급된 "실제 리그레션 체크 시나리오"를 구체화:
- 슈퍼 관리자 → 에이전시 관리 → 클라이언트 관리 → 이벤트 목록 → 웨비나 콘솔 진입 → 뒤로가기 링크 검증
- 모바일에서 햄버거 메뉴 → 드로어 열기 → 메뉴 항목 클릭 → 페이지 전환 확인
- 공개 페이지(/, /login, /webinar/[id])에서 TopNav 미표시 확인

---

## 결론

검토 문서는 **명세서를 기반으로 실무적 관점에서 리스크를 잘 식별**하고 있습니다. 다만, 실제 코드베이스와의 차이점을 반영하고, 구체적인 구현 가이드를 보강하면 더욱 완성도 높은 문서가 될 것입니다.

**검토 문서 활용 권장도**: ⭐⭐⭐⭐ (4/5)
- 명세서 기반 검토: 완벽
- 실무적 리스크 식별: 우수
- 구체적 구현 가이드: 양호 (보완 권장)
