# 사이드바 제거 및 상단 메뉴 전환 명세서

## 1. 개요

### 1.1 목적
현재 관리자 기능에서 사용 중인 사이드바가 전체적인 기능을 헷갈리게 하고, 방문자 UI도 헷갈리게 하는 문제를 해결하기 위해 사이드바를 제거하고 상단 메뉴 형식으로 전환합니다.

### 1.2 배경
- 현재 사이드바는 복잡한 트리 구조(Super Admin → Agency → Client → Webinar)로 인해 탐색이 어려움
- 데스크톱에서는 왼쪽 고정 사이드바, 모바일에서는 하단 고정 메뉴로 이중 구조
- 방문자(공개 웨비나 시청자)와 관리자의 UI가 혼재되어 혼란 발생
- 사이드바가 화면 공간을 차지하여 콘텐츠 영역이 제한됨

### 1.3 목표
- 사이드바를 완전히 제거하고 상단 네비게이션 바로 전환
- 관리자 기능을 명확하게 구분하고 접근성 향상
- 화면 공간 활용도 개선
- 모바일/데스크톱 일관된 UI 제공

---

## 2. 현재 사이드바 사용 현황 분석

### 2.1 사이드바 컴포넌트 구조

#### 2.1.1 주요 컴포넌트
- **`components/layout/Sidebar.tsx`**: 메인 사이드바 컴포넌트
  - 데스크톱: 왼쪽 고정 (`fixed left-0`, `w-64`)
  - 모바일: 하단 고정 (`lg:hidden fixed bottom-0`)
  - 로고, 트리 네비게이션, 사용자 정보, 로그아웃 버튼 포함

- **`components/layout/SidebarTree.tsx`**: 트리 구조 네비게이션
  - Super Admin → Agency → Client → Webinar 계층 구조
  - 동적 확장/축소 기능
  - 현재 경로에 따른 자동 확장

- **`components/layout/LayoutWrapper.tsx`**: 사이드바 표시 여부 결정
  - 공개 페이지: 사이드바 숨김
  - 관리 페이지: 사이드바 표시
  - 웨비나 관리 페이지: 사이드바 표시

- **`app/(super)/super/_components/SuperSidebar.tsx`**: 슈퍼 관리자 전용 사이드바
  - 섹션 기반 네비게이션 (Overview/Manage/Insights/Settings)

#### 2.1.2 레이아웃 구조
```typescript
// LayoutWrapper.tsx
<Sidebar />  // 왼쪽 고정 (데스크톱) 또는 하단 고정 (모바일)
<main className="ml-0 lg:ml-64">  // 사이드바 너비만큼 왼쪽 마진
  {children}
</main>
```

### 2.2 사이드바가 표시되는 페이지

#### 2.2.1 슈퍼 관리자 페이지
- `/super/dashboard` - 대시보드
- `/super/agencies` - 에이전시 관리
- `/super/clients` - 클라이언트 관리
- `/super/audit-logs` - 감사 로그
- `/super/statistics` - 전사 통계

#### 2.2.2 에이전시 페이지
- `/agency/[agencyId]/dashboard` - 대시보드
- `/agency/[agencyId]/clients` - 클라이언트 관리
- `/agency/[agencyId]/reports` - 리포트
- `/agency/[agencyId]/domains` - 도메인 관리

#### 2.2.3 클라이언트 페이지
- `/client/[clientId]/dashboard` - 대시보드
- `/client/[clientId]/accounts` - 가입계정관리
- `/client/[clientId]/settings/branding` - 브랜딩 설정
- `/client/[clientId]/surveys/[id]` - 설문조사 콘솔

#### 2.2.4 웨비나 관리 페이지
- `/webinar/[id]/console` - 운영 콘솔
- `/webinar/[id]/registrants` - 등록자 관리
- `/webinar/[id]/stats` - 통계

### 2.3 사이드바가 숨겨지는 페이지

#### 2.3.1 공개 페이지
- `/` - 홈
- `/login` - 로그인
- `/signup` - 회원가입
- `/privacy` - 개인정보처리방침
- `/unsubscribe` - 수신거부 설정

#### 2.3.2 웨비나 시청 페이지
- `/webinar/[id]` - 웨비나 입장 페이지
- `/webinar/[id]/live` - 라이브 시청 페이지

#### 2.3.3 설문조사 공개 페이지
- `/event/[...path]` - 설문조사 공개 페이지

### 2.4 현재 사이드바의 문제점

#### 2.4.1 복잡한 트리 구조
- Super Admin → Agency → Client → Webinar 4단계 계층 구조
- 이벤트 수가 많아지면 스크롤 지옥 발생
- 현재 위치 파악이 어려움

#### 2.4.2 이중 구조
- 데스크톱: 왼쪽 사이드바
- 모바일: 하단 메뉴
- 일관성 부족

#### 2.4.3 화면 공간 낭비
- 데스크톱에서 사이드바가 256px(16rem) 차지
- 콘텐츠 영역이 제한됨

#### 2.4.4 방문자 UI 혼란
- 관리자 사이드바와 공개 페이지 UI가 혼재
- 방문자가 관리자 기능에 접근할 수 있는 것처럼 보임

---

## 3. 상단 메뉴 설계

### 3.1 전체 구조

```
┌─────────────────────────────────────────────────────────────┐
│ [로고]  [메뉴1] [메뉴2] [메뉴3] ...        [사용자메뉴 ▼] │ ← 상단 고정
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                    콘텐츠 영역                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 상단 네비게이션 바 구조

#### 3.2.1 데스크톱 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ EventFlow  [대시보드] [관리] [통계] [설정]    [사용자 ▼] │
└─────────────────────────────────────────────────────────────┘
```

#### 3.2.2 모바일 레이아웃
```
┌─────────────────────────────────────────┐
│ [☰] EventFlow              [사용자 ▼] │ ← 햄버거 메뉴
└─────────────────────────────────────────┘
```

### 3.3 역할별 메뉴 구조

#### 3.3.1 슈퍼 관리자 메뉴
```
[로고: EventFlow]
├─ 📊 대시보드 (/super/dashboard)
├─ 🏢 에이전시 관리 (/super/agencies)
├─ 👥 클라이언트 관리 (/super/clients)
├─ 📋 감사 로그 (/super/audit-logs)
├─ 📈 전사 통계 (/super/statistics)
└─ [사용자 메뉴 ▼]
   ├─ ⚙️ 계정 설정 (/settings/profile)
   └─ 🚪 로그아웃
```

#### 3.3.2 에이전시 메뉴
```
[로고: EventFlow]
├─ 📊 대시보드 (/agency/[agencyId]/dashboard)
├─ 👥 클라이언트 (/agency/[agencyId]/clients)
├─ 📈 리포트 (/agency/[agencyId]/reports)
├─ 🌐 도메인 (/agency/[agencyId]/domains)
└─ [사용자 메뉴 ▼]
   ├─ ⚙️ 계정 설정 (/settings/profile)
   └─ 🚪 로그아웃
```

#### 3.3.3 클라이언트 메뉴
```
[로고: EventFlow]
├─ 📊 대시보드 (/client/[clientId]/dashboard)
├─ 🎥 이벤트 (/client/[clientId]/webinars)
├─ 👥 가입계정관리 (/client/[clientId]/accounts)
├─ 🎨 브랜딩 (/client/[clientId]/settings/branding)
└─ [사용자 메뉴 ▼]
   ├─ ⚙️ 계정 설정 (/settings/profile)
   └─ 🚪 로그아웃
```

#### 3.3.4 웨비나 관리 페이지 메뉴
웨비나 관리 페이지(`/webinar/[id]/console`, `/webinar/[id]/registrants`, `/webinar/[id]/stats`)에서는 상단에 웨비나 전용 서브 메뉴를 표시:

```
[로고: EventFlow]  [← 클라이언트로 돌아가기]
┌─────────────────────────────────────────────────────────────┐
│ 웨비나: [웨비나 제목]                                       │
│ [📺 라이브] [🎛️ 콘솔] [👥 등록자] [📊 통계]              │
└─────────────────────────────────────────────────────────────┘
```

### 3.4 Workspace Switcher (선택적)

상단 메뉴 우측에 현재 컨텍스트를 표시하는 드롭다운:

```
[사용자 메뉴 ▼]  [Agency: 에이전시A ▼]  [Client: 클라이언트B ▼]
```

또는 간단하게 브레드크럼 형식:

```
EventFlow > 에이전시A > 클라이언트B > 웨비나제목
```

---

## 4. 구현 계획

### 4.1 Phase 1: 상단 네비게이션 바 컴포넌트 생성

#### 4.1.1 새 컴포넌트 생성
- **`components/layout/TopNav.tsx`**: 상단 네비게이션 바 메인 컴포넌트
  - 역할별 메뉴 렌더링
  - 현재 경로 하이라이트
  - 모바일 햄버거 메뉴

- **`components/layout/TopNavMenu.tsx`**: 메뉴 아이템 컴포넌트
  - 드롭다운 메뉴 지원
  - 권한 기반 메뉴 표시/숨김

- **`components/layout/UserMenu.tsx`**: 사용자 메뉴 컴포넌트
  - 사용자 정보 표시
  - 계정 설정, 로그아웃

#### 4.1.2 레이아웃 수정
- **`components/layout/LayoutWrapper.tsx`** 수정
  - 사이드바 제거
  - 상단 네비게이션 바 추가
  - 콘텐츠 영역 마진 제거

### 4.2 Phase 2: 역할별 메뉴 구성

#### 4.2.1 슈퍼 관리자 메뉴
- 대시보드, 에이전시 관리, 클라이언트 관리, 감사 로그, 전사 통계

#### 4.2.2 에이전시 메뉴
- 대시보드, 클라이언트, 리포트, 도메인

#### 4.2.3 클라이언트 메뉴
- 대시보드, 이벤트, 가입계정관리, 브랜딩

#### 4.2.4 웨비나 관리 페이지 서브 메뉴
- 라이브, 콘솔, 등록자, 통계

### 4.3 Phase 3: 기존 사이드바 제거

#### 4.3.1 컴포넌트 제거/비활성화
- `components/layout/Sidebar.tsx` 제거 또는 비활성화
- `components/layout/SidebarTree.tsx` 제거 또는 비활성화
- `components/layout/SidebarContext.tsx` 제거 또는 비활성화 (사용하지 않는 경우)

#### 4.3.2 레이아웃 정리
- `app/(super)/super/layout.tsx`에서 `SuperSidebar` 제거
- 모든 관리자 페이지 레이아웃에서 사이드바 관련 코드 제거

### 4.4 Phase 4: 스타일링 및 반응형 처리

#### 4.4.1 데스크톱 스타일
- 상단 고정 네비게이션 바 (`fixed top-0`)
- 높이: 64px (4rem)
- 그림자 효과
- 호버 효과

#### 4.4.2 모바일 스타일
- 햄버거 메뉴 아이콘
- 드로어 메뉴 (왼쪽에서 슬라이드)
- 터치 친화적 버튼 크기

#### 4.4.3 콘텐츠 영역 조정
- 상단 네비게이션 바 높이만큼 상단 패딩 추가
- 전체 너비 활용

### 4.5 Phase 5: 웨비나 관리 페이지 서브 메뉴

#### 4.5.1 웨비나 헤더 컴포넌트
- **`components/webinar/WebinarHeader.tsx`**: 웨비나 관리 페이지 전용 헤더
  - 웨비나 제목 표시
  - 서브 메뉴 (라이브, 콘솔, 등록자, 통계)
  - 클라이언트로 돌아가기 링크

#### 4.5.2 서브 메뉴 활성화
- 현재 경로에 따라 해당 탭 하이라이트
- 권한에 따라 메뉴 표시/숨김

---

## 5. 기술 명세

### 5.1 컴포넌트 구조

```
components/layout/
├── TopNav.tsx              # 상단 네비게이션 바 메인 컴포넌트
├── TopNavMenu.tsx          # 메뉴 아이템 컴포넌트
├── UserMenu.tsx            # 사용자 메뉴 컴포넌트
├── MobileMenu.tsx          # 모바일 햄버거 메뉴 컴포넌트
└── LayoutWrapper.tsx       # 레이아웃 래퍼 (수정)

components/webinar/
└── WebinarHeader.tsx       # 웨비나 관리 페이지 헤더
```

### 5.2 상태 관리

#### 5.2.1 현재 경로 감지
- `usePathname()` 훅 사용
- 현재 경로에 따라 메뉴 활성화

#### 5.2.2 사용자 정보
- `useEffect`로 사용자 정보 조회
- 역할에 따라 메뉴 필터링

#### 5.2.3 모바일 메뉴 상태
- `useState`로 드로어 열림/닫힘 상태 관리

### 5.3 스타일링

#### 5.3.1 Tailwind CSS 클래스
```css
/* 상단 네비게이션 바 */
fixed top-0 left-0 right-0 z-50
bg-white shadow-md
h-16 (64px)

/* 메뉴 아이템 */
px-4 py-2 rounded-lg
hover:bg-gray-100
active:bg-blue-600 active:text-white

/* 모바일 드로어 */
fixed inset-y-0 left-0 w-64
bg-white shadow-xl
transform translate-x-0 (열림) / -translate-x-full (닫힘)
```

#### 5.3.2 반응형 브레이크포인트
- `lg:` (1024px 이상): 데스크톱 레이아웃
- `lg:` 미만: 모바일 레이아웃

### 5.4 라우팅

#### 5.4.1 메뉴 링크
- Next.js `Link` 컴포넌트 사용
- 클라이언트 사이드 네비게이션

#### 5.4.2 활성 상태
- `pathname === href` 또는 `pathname.startsWith(href + '/')` 체크

---

## 6. 마이그레이션 체크리스트

### 6.1 컴포넌트 생성
- [ ] `components/layout/TopNav.tsx` 생성
- [ ] `components/layout/TopNavMenu.tsx` 생성
- [ ] `components/layout/UserMenu.tsx` 생성
- [ ] `components/layout/MobileMenu.tsx` 생성
- [ ] `components/webinar/WebinarHeader.tsx` 생성

### 6.2 레이아웃 수정
- [ ] `components/layout/LayoutWrapper.tsx` 수정
  - [ ] 사이드바 제거
  - [ ] 상단 네비게이션 바 추가
  - [ ] 콘텐츠 영역 마진 제거
- [ ] `app/(super)/super/layout.tsx` 수정
  - [ ] `SuperSidebar` 제거
  - [ ] 상단 네비게이션 바 사용

### 6.3 페이지별 수정
- [ ] 슈퍼 관리자 페이지들 확인
- [ ] 에이전시 페이지들 확인
- [ ] 클라이언트 페이지들 확인
- [ ] 웨비나 관리 페이지들 확인
  - [ ] 웨비나 헤더 추가

### 6.4 스타일링
- [ ] 데스크톱 스타일 적용
- [ ] 모바일 스타일 적용
- [ ] 반응형 테스트
- [ ] 다크 모드 지원 (선택적)

### 6.5 기존 코드 정리
- [ ] `components/layout/Sidebar.tsx` 제거 또는 주석 처리
- [ ] `components/layout/SidebarTree.tsx` 제거 또는 주석 처리
- [ ] `components/layout/SidebarContext.tsx` 제거 또는 주석 처리 (사용하지 않는 경우)
- [ ] 사이드바 관련 import 제거

### 6.6 테스트
- [ ] 데스크톱 브라우저 테스트
- [ ] 모바일 브라우저 테스트
- [ ] 역할별 메뉴 표시 확인
- [ ] 권한 기반 메뉴 필터링 확인
- [ ] 네비게이션 동작 확인

---

## 7. 예상 효과

### 7.1 UI/UX 개선
- 화면 공간 활용도 향상 (256px 확보)
- 일관된 네비게이션 경험
- 모바일/데스크톱 통합 UI

### 7.2 사용성 개선
- 복잡한 트리 구조 제거로 탐색 용이
- 현재 위치 명확화
- 빠른 메뉴 접근

### 7.3 유지보수성 향상
- 단순한 구조로 코드 이해 용이
- 역할별 메뉴 분리로 관리 용이

---

## 8. 주의사항

### 8.1 기존 링크 호환성
- 기존 북마크나 외부 링크는 그대로 작동해야 함
- URL 구조 변경 없음

### 8.2 권한 체크
- 역할별 메뉴 표시는 기존 권한 시스템 유지
- RLS 정책과 일치해야 함

### 8.3 모바일 경험
- 햄버거 메뉴는 직관적이어야 함
- 터치 영역 충분히 확보

### 8.4 접근성
- 키보드 네비게이션 지원
- 스크린 리더 호환성
- ARIA 레이블 추가

---

## 9. 참고 자료

### 9.1 관련 문서
- `docs/sidebar-hierarchy-design.md` - 기존 사이드바 설계 문서
- `components/layout/Sidebar.tsx` - 현재 사이드바 구현
- `components/layout/SidebarTree.tsx` - 트리 구조 구현

### 9.2 참고 UI 패턴
- GitHub 상단 네비게이션
- Notion 상단 네비게이션
- Linear 상단 네비게이션

---

## 10. 구현 우선순위

### 우선순위 1 (필수)
1. 상단 네비게이션 바 컴포넌트 생성
2. 레이아웃 래퍼 수정
3. 기본 메뉴 구조 구현

### 우선순위 2 (중요)
4. 역할별 메뉴 구성
5. 모바일 메뉴 구현
6. 웨비나 관리 페이지 서브 메뉴

### 우선순위 3 (선택)
7. Workspace Switcher 추가
8. 브레드크럼 네비게이션
9. 다크 모드 지원

---

## 11. 예시 코드

### 11.1 TopNav.tsx 기본 구조

```typescript
'use client'

import { usePathname } from 'next/navigation'
import Link from 'next/link'
import { useState, useEffect } from 'react'
import { createClientSupabase } from '@/lib/supabase/client'
import TopNavMenu from './TopNavMenu'
import UserMenu from './UserMenu'
import MobileMenu from './MobileMenu'

export default function TopNav() {
  const pathname = usePathname()
  const [user, setUser] = useState<any>(null)
  const [organizations, setOrganizations] = useState<any>(null)
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false)
  
  useEffect(() => {
    // 사용자 정보 및 조직 정보 조회
    // ...
  }, [])
  
  // 역할별 메뉴 구성
  const menuItems = getMenuItems(organizations)
  
  return (
    <nav className="fixed top-0 left-0 right-0 z-50 bg-white shadow-md h-16">
      <div className="max-w-7xl mx-auto px-4 h-full flex items-center justify-between">
        {/* 로고 */}
        <Link href="/" className="text-2xl font-bold">
          EventFlow
        </Link>
        
        {/* 데스크톱 메뉴 */}
        <div className="hidden lg:flex items-center gap-4">
          {menuItems.map(item => (
            <TopNavMenu key={item.href} item={item} />
          ))}
          <UserMenu user={user} />
        </div>
        
        {/* 모바일 메뉴 버튼 */}
        <button
          className="lg:hidden"
          onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
        >
          ☰
        </button>
      </div>
      
      {/* 모바일 드로어 */}
      {mobileMenuOpen && (
        <MobileMenu
          items={menuItems}
          user={user}
          onClose={() => setMobileMenuOpen(false)}
        />
      )}
    </nav>
  )
}
```

### 11.2 LayoutWrapper.tsx 수정

```typescript
'use client'

import { usePathname } from 'next/navigation'
import TopNav from './TopNav'

function LayoutContent({ children }: { children: React.ReactNode }) {
  const pathname = usePathname()
  
  // 공개 페이지는 상단 네비게이션 바 없음
  const isPublicPage = pathname === '/' || 
    pathname.startsWith('/login') || 
    pathname.startsWith('/signup') ||
    pathname.startsWith('/webinar/') && !pathname.includes('/console') && !pathname.includes('/registrants') && !pathname.includes('/stats')
  
  if (isPublicPage) {
    return <>{children}</>
  }
  
  return (
    <>
      <TopNav />
      <main className="pt-16 min-h-screen">
        {children}
      </main>
    </>
  )
}

export default function LayoutWrapper({ children }: { children: React.ReactNode }) {
  return <LayoutContent>{children}</LayoutContent>
}
```

---

## 12. 마이그레이션 전략

### 12.1 점진적 전환 (권장)
1. 상단 네비게이션 바를 먼저 구현
2. 사이드바와 병행 운영 (토글 가능하게)
3. 사용자 피드백 수집
4. 사이드바 완전 제거

### 12.2 일괄 전환
1. 모든 컴포넌트 구현 완료
2. 테스트 완료
3. 한 번에 전환

---

## 13. 결론

사이드바를 제거하고 상단 메뉴로 전환함으로써:
- UI/UX 개선
- 화면 공간 활용도 향상
- 탐색 용이성 향상
- 일관된 사용자 경험 제공

이 명세서를 기반으로 단계적으로 구현하여 사용자 경험을 개선할 수 있습니다.
