# [ëª…ì„¸ì„œ] ì¶”ì •ì¹˜(ë³´ì •) ë°ì´í„°ë¥¼ `marketing_stats_daily`ì— Link IDê¹Œì§€ ê·€ì†í•˜ì—¬ ì£¼ì…í•˜ê¸° (Option A)

**ì‘ì„±ì¼**: 2026-02-03  
**ë²„ì „**: 1.0  
**ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

---

## 1. ëª©ì 

* ì–´ì œ 10ì‹œ ì´ì „ì— ëˆ„ë½ëœ ë¡œê·¸ë¡œ ì¸í•´ ì§‘ê³„ë˜ì§€ ì•Šì€ ì „í™˜/ë°©ë¬¸ ë°ì´í„°ë¥¼,
  **ìš°ë¦¬ê°€ ë§Œë“  ì¶”ì •ì¹˜(ì±„ë„ë³„ visits/ì „í™˜)**ë¡œ ë³´ì •í•˜ë˜,
* ê¸°ì¡´ UI/APIê°€ **marketing_campaign_link_id ê¸°ë°˜ ì§‘ê³„**ë¥¼ ì‚¬ìš©í•´ë„ ëˆ„ë½ë˜ì§€ ì•Šë„ë¡,
  ë³´ì • ë ˆì½”ë“œë¥¼ `marketing_stats_daily`ì— **ì‹¤ì œ link_idê¹Œì§€ ì±„ì›Œ "ì •ìƒ ë§í¬ ë°ì´í„°"ë¡œ ì£¼ì…**í•œë‹¤.

> ê²°ê³¼: `/client/:clientId/campaigns` í˜ì´ì§€ì˜
>
> * ë§í¬ ëª©ë¡ "ì „ì²´ í†µê³„ ìš”ì•½"
> * Sourceë³„ ì§‘ê³„
> * ë§í¬ë³„ row
>   ëª¨ë‘ ë³„ë„ API ë¡œì§ ë³€ê²½ ì—†ì´ ì •ìƒ ë°˜ì˜ë˜ëŠ” ìƒíƒœë¥¼ ëª©í‘œë¡œ í•œë‹¤.

---

## 2. ì™œ ì´ ë°©ì‹ì´ í•„ìš”í•œê°€ (ë°°ê²½/ë¬¸ì œ)

* ê¸°ì¡´ ë³´ì • ì„¤ê³„ëŠ” `marketing_campaign_link_id = null`ë¡œ ì ì¬ë˜ì–´ ë§í¬ ê¸°ë°˜ APIì—ì„œ ëˆ„ë½ë˜ì—ˆìŒ. 
* ë§í¬ APIë¥¼ "UTM ë§¤ì¹­"ìœ¼ë¡œ ë³´ì •í•˜ë ¤ í•˜ë©´ ì˜ˆì™¸ ì¼€ì´ìŠ¤(utm_campaign breakdown suffix, prefix-match ë“±)ê°€ ê³„ì† ëŠ˜ì–´ë‚¨.
* ë”°ë¼ì„œ **ë³´ì • ë°ì´í„°ë¥¼ ë§í¬ IDì— ê·€ì†**ì‹œì¼œ, ê¸°ì¡´ ì§‘ê³„ íŒŒì´í”„ë¼ì¸ì„ ê±´ë“œë¦¬ì§€ ì•Šê³ ë„ **í‘œì‹œ/ì§‘ê³„ ì¼ê´€ì„±**ì„ í™•ë³´í•œë‹¤.

---

## 3. ì „ì œ ì¡°ê±´

### 3.1 ë³´ì • ëŒ€ìƒ ë²”ìœ„(ì‹œê°„)

* **ëŒ€ìƒ:** "ì–´ì œ 10ì‹œ ì´ì „" êµ¬ê°„ì˜ ëˆ„ë½ë¶„ë§Œ ë³´ì •
* **ë¶ˆë³€:** ì–´ì œ 10ì‹œ ì´í›„ ë°ì´í„°ëŠ” ì ˆëŒ€ ìˆ˜ì •í•˜ì§€ ì•ŠìŒ

> ì‹œê°„ ê²½ê³„ëŠ” ë°˜ë“œì‹œ "ì ˆëŒ€ì‹œê°(ISO)" ê¸°ì¤€ìœ¼ë¡œ íŒë‹¨í•˜ë©°, ì„œë²„ ë¡œê·¸ì— ë‚¨ê¸´ë‹¤.

### 3.2 ë³´ì • ì›ë³¸(ìš°ë¦¬ê°€ ë§Œë“  ì¶”ì •ì¹˜)

* ì´ ì „í™˜: 82
* ì´ Visits: 1,289
* ì±„ë„ë³„ ë¶„ë°°(ê¸°ë³¸ê°’):

  * stibee/email: 65 / 655
  * keywordt/banner: 2 / 93
  * partner/referral: 1 / 68
  * community/social: 4 / 227
  * sns/social: 3 / 246

---

## 4. í•µì‹¬ ì„¤ê³„ ì›ì¹™ (Non-Negotiable)

1. **ê¸°ì¡´ ì‹œìŠ¤í…œ ì¡´ì¤‘**

* API/ì§‘ê³„ ë¡œì§ì„ ìµœì†Œ ë³€ê²½(ê°€ëŠ¥í•˜ë©´ 0 ë³€ê²½)
* ë°ì´í„°ëŠ” `marketing_stats_daily`ì— "ì •ìƒ ì§‘ê³„ ë°ì´í„°" í˜•íƒœë¡œ ì ì¬

2. **ë©±ë“±ì„± ë³´ì¥**

* ìŠ¤í¬ë¦½íŠ¸ ì¬ì‹¤í–‰í•´ë„ ë™ì¼ ê²°ê³¼(ì¤‘ë³µ ëˆ„ì  ê¸ˆì§€)
* upsert í‚¤ëŠ” ê¸°ì¡´ í…Œì´ë¸” ìœ ë‹ˆí¬ í‚¤/íŒ¨í„´ì„ ë”°ë¥¸ë‹¤

3. **ì‹¤ì¸¡ ë°ì´í„° ìš°ì„ **

* ê°™ì€ bucket_date + link_idì— ì‹¤ì¸¡ì´ ì´ë¯¸ ìˆëŠ” ê²½ìš°, backfillì€ ê±´ë„ˆëœ€
* ì‹¤ì¸¡ ë°ì´í„°ëŠ” `last_aggregated_at`ì´ ì–´ì œ 10ì‹œ ì´í›„ì¸ ê²½ìš°ë¡œ íŒë‹¨

---

## 5. ë°ì´í„° ëª¨ë¸/í‚¤ ì „ëµ

### 5.1 ì ì¬ ëŒ€ìƒ í…Œì´ë¸”

* `marketing_stats_daily`

### 5.2 ë ˆì½”ë“œ ë‹¨ìœ„(ë²„í‚·)

* `bucket_date`: ì–´ì œ ë‚ ì§œ(YYYY-MM-DD) ë‹¨ìœ„ë¡œ ì ì¬
* "ì–´ì œ 10ì‹œ ì´ì „"ì´ë¼ëŠ” ì‹œê°„ ê°œë…ì€ `bucket_date`ë¡œ í‘œí˜„ì´ ì–´ë ¤ìš°ë¯€ë¡œ:
  * **ì „ëµ:** ì–´ì œ ë‚ ì§œ bucketì—ë§Œ backfillì„ ë„£ë˜, "ì–´ì œ 10ì‹œ ì´í›„" ì‹¤ì¸¡ ë ˆì½”ë“œì™€ ì¶©ëŒí•˜ì§€ ì•Šê²Œ `checkConflict` í•¨ìˆ˜ë¡œ ê°€ë“œ

### 5.3 ìœ ë‹ˆí¬ í‚¤(ë©±ë“± upsert í‚¤)

ì‹¤ì œ í”„ë¡œì íŠ¸ì˜ `marketing_stats_daily` ìœ ë‹ˆí¬ ì œì•½:

```sql
create unique index uq_marketing_stats_daily_key 
  on public.marketing_stats_daily(
    client_id,
    bucket_date,
    campaign_id,
    coalesce(marketing_campaign_link_id, '00000000-0000-0000-0000-000000000000'::uuid),
    coalesce(utm_source, '__null__'),
    coalesce(utm_medium, '__null__'),
    coalesce(utm_campaign, '__null__')
  );
```

**ì¤‘ìš”:**
ê°™ì€ ë‚ ì§œ/ë§í¬ì— ì‹¤ì¸¡ ì§‘ê³„ê°€ ì´ë¯¸ ì¡´ì¬í•œë‹¤ë©´, **ë®ì–´ì“°ì§€ ë§ê³ ** ì•„ë˜ ì¤‘ í•˜ë‚˜ë¡œ ì²˜ë¦¬í•œë‹¤.

* **ìš°ì„ ê¶Œ ê·œì¹™(ê¶Œì¥): ì‹¤ì¸¡ ìš°ì„ **

  * ì‹¤ì¸¡ rowê°€ ì¡´ì¬í•˜ë©´ backfillì€ ë„£ì§€ ì•Šê±°ë‚˜,
  * ì‹¤ì¸¡ ë°ì´í„°ëŠ” `last_aggregated_at`ì´ ì–´ì œ 10ì‹œ ì´í›„ì¸ ê²½ìš°ë¡œ íŒë‹¨

---

## 6. Link ID ë§¤í•‘ ê·œì¹™ (ê°€ì¥ ì¤‘ìš”)

ë³´ì • ë°ì´í„°ëŠ” ë°˜ë“œì‹œ **ê° ì±„ë„ì´ ê·€ì†ë  ëŒ€í‘œ ë§í¬(marketing_campaign_link_id)**ë¥¼ ê°€ì ¸ì•¼ í•œë‹¤.

### 6.1 ëŒ€í‘œ ë§í¬ ì„ ì • ì›ì¹™

* ê°™ì€ client_id ì•ˆì—ì„œ,
* `(utm_source, utm_medium, utm_campaign)` ì¡°í•©ì´ ë™ì¼í•œ ë§í¬ê°€ ìˆìœ¼ë©´ ê·¸ ë§í¬ ì‚¬ìš©
* ì—†ìœ¼ë©´ "ë³´ì •ìš© ëŒ€í‘œ ë§í¬"ë¥¼ ìƒì„±:
  * ì´ë¦„: `[Backfill] {ì±„ë„ëª…} {utm_campaign}`
  * ì˜ˆ: `[Backfill] ê´‘ê³ ë©”ì¼ webinar_2026`
  * `status: 'active'`
  * `landing_variant: 'register'`
  * CIDëŠ” ìë™ ìƒì„± (ì¤‘ë³µ ì²´í¬ í¬í•¨)

### 6.2 campaign breakdown ì „ëµê³¼ ì¶©ëŒ ë°©ì§€

ê¸°ì¡´ ê³„íšì€ `utm_campaign`ì— breakdownì„ ë¶™ì´ëŠ” ë°©ì‹ì´ì—ˆìŒ. 
ì˜µì…˜ Aì—ì„œëŠ” ë§í¬ ë§¤ì¹­ì„ ìœ„í•´:

* **ë§í¬ì˜ ê¸°ì¤€ utm_campaignì„ "base"ë¡œ ê³ ì •**

  * ì˜ˆ: `webinar_2026`
* breakdownì€ **utm_campaignì— ë„£ì§€ ë§ê³ **, ì—¬ëŸ¬ rowë¡œ ë¶„ì‚°

  * ê°™ì€ `marketing_campaign_link_id`ë¥¼ ì‚¬ìš©
  * `utm_campaign`ì€ base ê°’ ìœ ì§€ (ì˜ˆ: `webinar_2026`)
  * breakdown ì •ë³´ëŠ” í•„ìš”ì‹œ `utm_content`ì— ì €ì¥ ê°€ëŠ¥ (í˜„ì¬ëŠ” ì‚¬ìš© ì•ˆ í•¨)

> ìš”ì : **link_idë¥¼ ì±„ìš°ëŠ” ìˆœê°„, breakdownì„ campaign í•„ë“œë¡œ ë¶„ì‚°í•  í•„ìš”ê°€ ì¤„ì–´ë“¦.**
> "ì‹¤ì œì²˜ëŸ¼ ë³´ì´ê²Œ"ëŠ” visits ê°’ ìì²´ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ìª¼ê°œë©´ ì¶©ë¶„í•¨.

---

## 7. ì ì¬ ë°ì´í„° ìŠ¤í™ (ë ˆì½”ë“œ í•„ë“œ)

ê° rowëŠ” ì•„ë˜ ìµœì†Œ í•„ë“œë¥¼ ì±„ìš´ë‹¤:

* `client_id`
* `bucket_date` (ì–´ì œ)
* `campaign_id`
* `marketing_campaign_link_id` (ëŒ€í‘œ ë§í¬ id) **â† í•„ìˆ˜ (null ê¸ˆì§€)**
* `utm_source`, `utm_medium`, `utm_campaign` (ë§í¬ì™€ ë™ì¼í•œ base ê°’)
* `visits` (ìì—°ìˆ˜)
* `conversions` (ìì—°ìˆ˜)

**ì„ íƒ(ìˆìœ¼ë©´ ì±„ì›€)**

* `created_at/updated_at` (ìë™)
* `last_aggregated_at` (ìë™)

---

## 8. ë¶„ë°° ë¡œì§(ì¶”ì •ì¹˜ â†’ ë ˆì½”ë“œ ì„¸ë¶„í™”)

### 8.1 ì±„ë„ë³„ ëª©í‘œ í•©ê³„

ë¬¸ì„œ ê¸°ì¤€ í•©ê³„ë¥¼ ìœ ì§€í•œë‹¤. 

* stibee/email: visits 655, conversions 65
* keywordt/banner: 93, 2
* partner/referral: 68, 1
* community/social: 227, 4
* sns/social: 246, 3
* ì´í•©: 1,289 / 82

### 8.2 "í©ë¿Œë¦¬ê¸°" ë ˆì½”ë“œ ìƒì„± ê·œì¹™

ê° ì±„ë„ì€ **3~6ê°œì˜ sub-row**ë¡œ ìª¼ê° ë‹¤(ì‹¤ì œ ë¡œê·¸ì²˜ëŸ¼ ë³´ì´ê²Œ).

* sub-rowëŠ” ëª¨ë‘ ê°™ì€ link_idë¥¼ ê°–ëŠ”ë‹¤(ì¤‘ìš”)
* `visits` ë¶„ë°°: í•©ì´ ëª©í‘œ visitsê°€ ë˜ë„ë¡ breakdown ë¹„ìœ¨ë¡œ ë¶„ë°°
* `conversions` ë¶„ë°°: visits ë¹„ìœ¨ë¡œ ë‚˜ëˆ„ë˜, ë°˜ì˜¬ë¦¼ ì˜¤ì°¨ëŠ” ë§ˆì§€ë§‰ rowê°€ í¡ìˆ˜
* `utm_campaign`ì€ base ê°’ ìœ ì§€ (breakdown suffix ì—†ìŒ)

> ì´ ë¶„ì‚°ì€ "utm_campaign breakdown"ì´ ì•„ë‹ˆë¼ "row ë‹¤ê±´"ìœ¼ë¡œ êµ¬í˜„í•œë‹¤.

### 8.3 ì˜¤ì°¨ í—ˆìš©

* ì´í•© ê²€ì¦ ê¸°ì¤€:

  * conversions: 82 (Â±0 ê¶Œì¥, ìµœëŒ€ Â±1)
  * visits: 1,289 (Â±0 ê¶Œì¥, ìµœëŒ€ Â±5)

---

## 9. ì‹¤í–‰ ë‹¨ê³„ (ìš´ì˜ Runbook)

### Step 0) ì‚¬ì „ ì ê²€

1. ì–´ì œ ë‚ ì§œ bucketì— ì´ë¯¸ ì¡´ì¬í•˜ëŠ” `marketing_stats_daily` ë ˆì½”ë“œ í™•ì¸
2. ì±„ë„ë³„ ëŒ€í‘œ ë§í¬ ì¡´ì¬ ì—¬ë¶€ í™•ì¸(ì—†ìœ¼ë©´ ìƒì„± ê³„íš ìˆ˜ë¦½)
3. "ì–´ì œ 10ì‹œ ì´í›„" êµ¬ê°„ ì‹¤ì¸¡ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°, í•´ë‹¹ ë§í¬/dateì— ì¶©ëŒ ê°€ëŠ¥ì„± í™•ì¸

### Step 1) backfill ì‹¤í–‰

```bash
npx tsx scripts/backfill-estimated-stats.ts [clientId] [campaignId]
```

* ì˜µì…˜ A ë°©ì‹ìœ¼ë¡œ ìˆ˜ì •ëœ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
* "link_id null" ê¸ˆì§€
* "ëŒ€í‘œ ë§í¬ ë§¤í•‘" í•„ìˆ˜
* upsert í‚¤ ê¸°ë°˜ ë©±ë“±ì„±

### Step 2) ê²°ê³¼ ê²€ì¦(SQL/ìŠ¤í¬ë¦½íŠ¸)

* bucket_date(ì–´ì œ) ê¸°ì¤€ìœ¼ë¡œ:

  * ì´ visits = 1,289
  * ì´ conversions = 82
* ë§í¬ë³„ë¡œ:

  * stibee ëŒ€í‘œ ë§í¬ì˜ í•©ê³„ê°€ 655/65ì¸ì§€
  * ê¸°íƒ€ ì±„ë„ë„ ë™ì¼

### Step 3) UI í™•ì¸

* `/client/:clientId/campaigns`ì—ì„œ

  * "ì „ì²´ í†µê³„ ìš”ì•½"ì— visits/conversionsê°€ ë°˜ì˜
  * Sourceë³„ ì§‘ê³„ì— 5ê°œ ì±„ë„ì´ ë…¸ì¶œ
  * ë§í¬ë³„ rowì—ë„ ìˆ˜ì¹˜ê°€ ë¶™ìŒ

---

## 10. ë¦¬ìŠ¤í¬ ì²´í¬

### 10.1 ì‹¤ì¸¡ê³¼ ì¶©ëŒ(ë®ì–´ì“°ê¸° ìœ„í—˜)

* ê°™ì€ bucket_date + link_idì— ì‹¤ì¸¡ì´ ì´ë¯¸ ìˆëŠ” ê²½ìš°,

  * backfillì´ ë®ì–´ì“°ë©´ ì•ˆ ë¨(ì‹¤ì¸¡ ìš°ì„ )
* í•´ê²°:

  * `checkConflict` í•¨ìˆ˜ë¡œ ì¶©ëŒ ê²€ì‚¬
  * ì¶©ëŒ ì‹œ "í•´ë‹¹ ë§í¬ëŠ” backfill ì œì™¸" (ì‹¤ì¸¡ ìš°ì„  ì •ì±…)

### 10.2 ì¬ì‹¤í–‰ ì‹œ ëˆ„ì (í­ë°œ)

* ë°˜ë“œì‹œ upsert + ê³ ì •ëœ í‚¤ë¡œ ë©±ë“±ì„± ë³´ì¥
* ê¸°ì¡´ ë°ì´í„°ê°€ ìˆìœ¼ë©´ update, ì—†ìœ¼ë©´ insert

### 10.3 ì¶”ì •ì¹˜ í‘œê¸°

* ì™¸ë¶€ ë³´ê³ /ì •ì‚°ì— ì“°ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ

  * ìµœì†Œí•œ ë‚´ë¶€ ë¬¸ì„œ/ë³´ê³ ì„œì— "ì¶”ì •ì¹˜ í¬í•¨" ëª…ì‹œ
  * ë§í¬ ì´ë¦„ì— `[Backfill]` ì ‘ë‘ì‚¬ë¡œ í‘œê¸°

---

## 11. ì™„ë£Œ ì¡°ê±´(DoD)

1. âœ… `marketing_stats_daily`ì— backfill rowê°€ **ëª¨ë‘ marketing_campaign_link_idë¥¼ ê°€ì§„ë‹¤**
2. âœ… ì–´ì œ bucket ê¸°ì¤€ ì´í•©ì´ **1,289 visits / 82 conversions**ë¡œ ë§ëŠ”ë‹¤
3. âœ… `/client/:clientId/campaigns`ì˜

   * ì „ì²´ í†µê³„ ìš”ì•½
   * Sourceë³„ ì§‘ê³„
   * ë§í¬ë³„ row
     ëª¨ë‘ì—ì„œ ìˆ˜ì¹˜ê°€ ë…¸ì¶œëœë‹¤
4. âœ… ìŠ¤í¬ë¦½íŠ¸ ì¬ì‹¤í–‰í•´ë„ ìˆ˜ì¹˜ê°€ ì¦ê°€í•˜ì§€ ì•ŠëŠ”ë‹¤(ë©±ë“±)

---

## 12. ê¸°ì¡´ ë¬¸ì„œì—ì„œ ë°”ë€ŒëŠ” ì (ëª…ì‹œ)

ê¸°ì¡´ ê³„íšì˜ "ë§í¬ ID: null(ì¶”ì •ì¹˜)" í•­ëª©ì„ ì•„ë˜ë¡œ êµì²´í•œë‹¤. 

* âŒ ë§í¬ ID: null
* âœ… ë§í¬ ID: **ì±„ë„ ëŒ€í‘œ link_idë¡œ ì±„ì›€** (ì˜µì…˜ A)

---

## 13. ëŒ€í‘œ ë§í¬ ë§¤í•‘ ê·œì¹™ í‘œ

| ì±„ë„ í‚¤ | UTM Source | UTM Medium | UTM Campaign | ëŒ€í‘œ ë§í¬ ì´ë¦„ | ìƒì„± ì¡°ê±´ |
|---------|-----------|-----------|-------------|--------------|----------|
| email | stibee | email | webinar_2026 | `[Backfill] ê´‘ê³ ë©”ì¼ webinar_2026` | ê¸°ì¡´ ë§í¬ ì—†ì„ ë•Œ |
| keywordt | keywordt | banner | homepage_banner | `[Backfill] í‚¤ì›ŒíŠ¸ ë°°ë„ˆ homepage_banner` | ê¸°ì¡´ ë§í¬ ì—†ì„ ë•Œ |
| partner | partner | referral | association | `[Backfill] í˜‘íšŒ/íŒŒíŠ¸ë„ˆ association` | ê¸°ì¡´ ë§í¬ ì—†ì„ ë•Œ |
| community | community | social | community_content | `[Backfill] ì»¤ë®¤ë‹ˆí‹°/ì˜¤í”ˆì±„ë„ community_content` | ê¸°ì¡´ ë§í¬ ì—†ì„ ë•Œ |
| sns | sns | social | sns_promotion | `[Backfill] SNS/ë©”ì‹œì§€ sns_promotion` | ê¸°ì¡´ ë§í¬ ì—†ì„ ë•Œ |

**ë§¤ì¹­ ìš°ì„ ìˆœìœ„:**
1. ê°™ì€ `client_id` + `target_campaign_id`ì—ì„œ
2. `utm_source`, `utm_medium`, `utm_campaign`ì´ ëª¨ë‘ ì¼ì¹˜í•˜ëŠ” ë§í¬
3. `status = 'active'`ì¸ ë§í¬
4. ì—†ìœ¼ë©´ ìœ„ ì´ë¦„ìœ¼ë¡œ ìƒˆ ë§í¬ ìƒì„±

---

## 14. ì¶©ëŒ(ì‹¤ì¸¡ ì¡´ì¬) ì‹œ ì²˜ë¦¬ ì •ì±…

### ì •ì±…: ì‹¤ì¸¡ ìš°ì„  (ê¶Œì¥, êµ¬í˜„ë¨)

**ê·œì¹™:**
- ê°™ì€ `bucket_date` + `marketing_campaign_link_id` + UTM ì¡°í•©ì— ëŒ€í•´
- `last_aggregated_at`ì´ ì–´ì œ 10ì‹œ ì´í›„ì¸ ë ˆì½”ë“œê°€ ìˆìœ¼ë©´ â†’ ì‹¤ì¸¡ ë°ì´í„°ë¡œ ê°„ì£¼
- ì‹¤ì¸¡ ë°ì´í„°ê°€ ìˆìœ¼ë©´ backfillì€ í•´ë‹¹ ì¡°í•©ì— ëŒ€í•´ ê±´ë„ˆëœ€

**ì¥ì :**
- ì‹¤ì¸¡ ë°ì´í„°ì˜ ì •í™•ì„± ë³´ì¥
- ì¤‘ë³µ ì§‘ê³„ ë°©ì§€
- ëª…í™•í•œ ìš°ì„ ìˆœìœ„

**ë‹¨ì :**
- ì¼ë¶€ ì±„ë„ì´ backfillë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ (í•˜ì§€ë§Œ ì‹¤ì¸¡ì´ ìˆìœ¼ë©´ ë¬¸ì œ ì—†ìŒ)

---

## 15. backfill ë ˆì½”ë“œ ë¶„ì‚° ìƒ˜í”Œ ë°ì´í„°

### ì±„ë„: stibee/email (ì „í™˜ 65, Visits 655)

| bucket_date | marketing_campaign_link_id | utm_source | utm_medium | utm_campaign | visits | conversions |
|------------|----------------------------|-----------|-----------|-------------|--------|------------|
| 2026-02-02 | {link_id_email} | stibee | email | webinar_2026 | 182 | 18 |
| 2026-02-02 | {link_id_email} | stibee | email | webinar_2026 | 146 | 14 |
| 2026-02-02 | {link_id_email} | stibee | email | webinar_2026 | 97 | 10 |
| 2026-02-02 | {link_id_email} | stibee | email | webinar_2026 | 121 | 12 |
| 2026-02-02 | {link_id_email} | stibee | email | webinar_2026 | 109 | 11 |

**í•©ê³„ ê²€ì¦:** 182+146+97+121+109 = 655 visits, 18+14+10+12+11 = 65 conversions âœ…

### ì±„ë„: keywordt/banner (ì „í™˜ 2, Visits 93)

| bucket_date | marketing_campaign_link_id | utm_source | utm_medium | utm_campaign | visits | conversions |
|------------|----------------------------|-----------|-----------|-------------|--------|------------|
| 2026-02-02 | {link_id_keywordt} | keywordt | banner | homepage_banner | 41 | 1 |
| 2026-02-02 | {link_id_keywordt} | keywordt | banner | homepage_banner | 27 | 0 |
| 2026-02-02 | {link_id_keywordt} | keywordt | banner | homepage_banner | 19 | 1 |
| 2026-02-02 | {link_id_keywordt} | keywordt | banner | homepage_banner | 6 | 0 |

**í•©ê³„ ê²€ì¦:** 41+27+19+6 = 93 visits, 1+0+1+0 = 2 conversions âœ…

**ì°¸ê³ :** 
- ëª¨ë“  sub-rowëŠ” ê°™ì€ `marketing_campaign_link_id`ë¥¼ ì‚¬ìš©
- `utm_campaign`ì€ base ê°’ë§Œ ì‚¬ìš© (breakdown suffix ì—†ìŒ)
- breakdown ì •ë³´ëŠ” visits/conversions ë¶„ì‚°ìœ¼ë¡œë§Œ í‘œí˜„

---

## 16. êµ¬í˜„ íŒŒì¼

- **ìŠ¤í¬ë¦½íŠ¸**: `scripts/backfill-estimated-stats.ts` (ì˜µì…˜ A ë°©ì‹ìœ¼ë¡œ ìˆ˜ì •ë¨)
- **ëª…ì„¸ì„œ**: `docs/ì–´ì œ10ì‹œì´ì „_ë³´ì •_ì˜µì…˜A_ëª…ì„¸ì„œ.md` (ë³¸ ë¬¸ì„œ)

---

## 17. ì‹¤í–‰ ì˜ˆì‹œ

```bash
# ìë™ìœ¼ë¡œ ìµœê·¼ í™œì„± ìº í˜ì¸ ì„ íƒ
npx tsx scripts/backfill-estimated-stats.ts

# íŠ¹ì • í´ë¼ì´ì–¸íŠ¸/ìº í˜ì¸ ì§€ì •
npx tsx scripts/backfill-estimated-stats.ts 55317496-d3d6-4e65-81d3-405892de78ab {campaignId}
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
================================================================================
ì–´ì œ 10ì‹œ ì´ì „ ëˆ„ë½ëœ ì§‘ê³„ ë°ì´í„° ë³´ì • (ì¶”ì •ì¹˜ ê¸°ë°˜) - ì˜µì…˜ A
================================================================================

ğŸ“… ë³´ì • ê¸°ê°„:
   ì–´ì œ 10ì‹œ ì´ì „ (KST) = 2026-02-02T01:00:00.000Z (UTC)
   ë²„í‚· ë‚ ì§œ: 2026-02-02

1. í´ë¼ì´ì–¸íŠ¸ ë° ìº í˜ì¸ í™•ì¸
--------------------------------------------------------------------------------
  âœ… ìº í˜ì¸: {campaignId}
  âœ… í´ë¼ì´ì–¸íŠ¸: {clientId}

2. ê¸°ì¡´ ì§‘ê³„ ë°ì´í„° í™•ì¸
--------------------------------------------------------------------------------
  ê¸°ì¡´ ì§‘ê³„ ë°ì´í„°:
    ì „í™˜: 2ê°œ
    Visits: 0ê°œ

3. ì±„ë„ë³„ ëŒ€í‘œ ë§í¬ ì°¾ê¸°/ìƒì„±
--------------------------------------------------------------------------------
  âœ… email: {link_id_email}
  âœ… keywordt: {link_id_keywordt}
  âœ… partner: {link_id_partner}
  âœ… community: {link_id_community}
  âœ… sns: {link_id_sns}

4. ë³´ì • ë°ì´í„° ìƒì„±
--------------------------------------------------------------------------------
  ìƒì„±ëœ ë³´ì • ë°ì´í„°: 19ê°œ ë ˆì½”ë“œ
  ì´ Visits: 1289ê°œ
  ì´ ì „í™˜: 82ê°œ
  í‰ê·  CVR: 6.36%

5. ì¶©ëŒ í™•ì¸ ë° ë³´ì • ë°ì´í„° ì‚½ì…
--------------------------------------------------------------------------------
  âœ… ì‚½ì… ì™„ë£Œ:
     Inserted: 19ê°œ
     Updated: 0ê°œ
     Skipped: 0ê°œ
     Conflicts: 0ê°œ (ì‹¤ì¸¡ ë°ì´í„° ìš°ì„ )

6. ë³´ì • í›„ í™•ì¸
--------------------------------------------------------------------------------
  ë³´ì • í›„ ì§‘ê³„ ë°ì´í„°:
    ì „í™˜: 84ê°œ (ê¸°ì¡´: 2ê°œ, ì¶”ê°€: 82ê°œ)
    Visits: 1289ê°œ (ê¸°ì¡´: 0ê°œ, ì¶”ê°€: 1289ê°œ)
    í‰ê·  CVR: 6.52%

  ì±„ë„ë³„ ì§‘ê³„:
    stibee: ì „í™˜ 65ê°œ, Visits 655ê°œ, CVR 9.92%
    sns: ì „í™˜ 3ê°œ, Visits 246ê°œ, CVR 1.22%
    community: ì „í™˜ 4ê°œ, Visits 227ê°œ, CVR 1.76%
    keywordt: ì „í™˜ 2ê°œ, Visits 93ê°œ, CVR 2.15%
    partner: ì „í™˜ 1ê°œ, Visits 68ê°œ, CVR 1.47%

================================================================================
âœ… ë³´ì • ì™„ë£Œ (ì˜µì…˜ A: Link ID ì±„ì›€ ë°©ì‹)

ğŸ“ ì°¸ê³ :
  - ì–´ì œ 10ì‹œ ì´í›„ ë°ì´í„°ëŠ” ë³€ê²½í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
  - ë³´ì •ëœ ë°ì´í„°ëŠ” "ì •ìƒ ì§‘ê³„ ë°ì´í„°"ì²˜ëŸ¼ marketing_campaign_link_idë¥¼ ì±„ì›Œ ë„£ì—ˆìŠµë‹ˆë‹¤.
  - ê¸°ì¡´ API/ì§‘ê³„ ë¡œì§ ë³€ê²½ ì—†ì´ ìë™ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤.
  - ì‹¤ì¸¡ ë°ì´í„°ì™€ ì¶©ëŒí•˜ëŠ” ê²½ìš° ì‹¤ì¸¡ ë°ì´í„°ë¥¼ ìš°ì„ í–ˆìŠµë‹ˆë‹¤.
```

---

**ì™„ë£Œì¼**: 2026-02-03  
**ê²€ì¦ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ, í…ŒìŠ¤íŠ¸ ëŒ€ê¸°
