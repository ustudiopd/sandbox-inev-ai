# 콘텐츠 에디터 이식 가이드 검토 보고서

**작성 일자**: 2026-01-28  
**대상 프로젝트**: EventLive  
**기반 가이드**: `ustudio-web/docs/콘텐츠_에디터_완전_이식_가이드.md`  
**검토 목적**: EventLive 프로젝트에 노블sh 기반 콘텐츠 에디터 이식 가능성 및 필요 조치 사항 검토

---

## 📋 목차

1. [현재 상태 분석](#1-현재-상태-분석)
2. [가이드 문서 검토](#2-가이드-문서-검토)
3. [호환성 분석](#3-호환성-분석)
4. [차이점 및 개선 사항](#4-차이점-및-개선-사항)
5. [이식 전략](#5-이식-전략)
6. [권장 사항](#6-권장-사항)

---

## 1. 현재 상태 분석

### 1.1 EventLive 프로젝트 에디터 현황

**이미 구현된 기능**:
- ✅ `BlogEditor.tsx`: Novel.sh 기반 메인 에디터 컴포넌트
- ✅ `extensions.tsx`: 슬래시 메뉴 확장 설정
- ✅ `BubbleMenu.tsx`: 텍스트 선택 메뉴
- ✅ `ImageResizePlugin.tsx`: 이미지 리사이즈 플러그인
- ✅ 기본 편집 기능 (Bold, Italic, Underline, Strikethrough, Code)
- ✅ 블록 타입 (Heading, List, Quote, Code Block)
- ✅ 이미지 업로드 (커스텀 구현)
- ✅ YouTube 임베드

**기술 스택 호환성**:
- ✅ Next.js 16.0.10 (가이드 요구: 16+)
- ✅ TypeScript 5+ (가이드 요구: 5.5+)
- ✅ Tailwind CSS 3.4.1 (가이드 요구: Tailwind CSS)
- ✅ @tailwindcss/typography 0.5.19 (가이드 요구: 필수)
- ✅ novel 1.0.2 (가이드 요구: 1.0.2)
- ✅ 필요한 Tiptap 확장 패키지 대부분 설치됨

### 1.2 설치된 패키지 확인

**필수 패키지 (가이드 기준)**:
```json
{
  "novel": "^1.0.2", ✅
  "@tiptap/core": "^3.16.0", ✅ (starter-kit에 포함)
  "@tiptap/react": "^3.16.0", ✅
  "@tiptap/starter-kit": "^3.16.0", ✅
  "@tiptap/html": "^3.16.0", ✅
  "@tiptap/extension-image": "^3.16.0", ✅
  "@tiptap/extension-link": "^3.16.0", ✅
  "@tiptap/extension-task-list": "^3.16.0", ✅
  "@tiptap/extension-task-item": "^3.16.0", ✅
  "@tiptap/extension-youtube": "^3.16.0", ✅
  "@tailwindcss/typography": "^0.5.19", ✅
  "lucide-react": "^0.562.0", ✅
  "jotai": "❌ 미설치" (Novel.sh 내부 사용, 선택사항)
}
```

**누락된 패키지 (가이드 기준)**:
- `@tiptap/extension-color`: ❌ (가이드에서 권장)
- `@tiptap/extension-text-style`: ❌ (가이드에서 권장)
- `@tiptap/extension-highlight`: ❌ (가이드에서 권장)

---

## 2. 가이드 문서 검토

### 2.1 가이드 문서의 핵심 내용

**주요 기능**:
1. 슬래시 메뉴 (`/` 명령어)
2. 이미지 업로드 및 리사이즈
3. YouTube 임베드
4. Bubble Menu (텍스트 선택 메뉴)
5. 이미지 드래그 앤 드롭
6. 이미지 복사-붙여넣기
7. 라이트박스 모달 (이미지 확대) - EventLive에는 없음

**핵심 포인트**:
1. ✅ `renderItems` import 필수
2. ✅ `createSlashCommand`에서 `render: renderItems` 설정 필수
3. ✅ `extensions` 배열에 `slashCommand` 포함 필수
4. ✅ `immediatelyRender={false}` 설정 (SSR 환경)
5. ✅ `handleCommandNavigation` 연결 (키보드 네비게이션)
6. ✅ `onCommand={({ editor, range }) => ...}` 형식 (구조 분해 할당)

### 2.2 가이드의 시행착오 및 해결 방법

**주요 시행착오**:
1. 슬래시 메뉴가 나타나지 않음 → `renderItems` 누락
2. 메뉴는 보이지만 명령이 적용되지 않음 → `onCommand` 형식 오류
3. "Empty text nodes are not allowed" 에러 → 빈 텍스트 노드 사용
4. 슬래시 문자(`/`)가 남아있음 → `range` 확인 누락
5. `addNodeView(...) is not a function` 에러 → `UpdatedImage` 사용 필요
6. SSR 에러 → 서버용 확장 파일 분리 필요
7. 키보드 네비게이션 작동 안 함 → `handleCommandNavigation` 누락
8. SSR 경고 → `immediatelyRender={false}` 설정 필요
9. 중복 확장 이름 경고 → `StarterKit`에서 `link: false` 설정

---

## 3. 호환성 분석

### 3.1 EventLive vs 가이드 구현 비교

| 항목 | 가이드 권장 방식 | EventLive 현재 구현 | 호환성 |
|------|----------------|-------------------|--------|
| **슬래시 메뉴** | `renderItems` + 수동 렌더링 | `renderItems` + 수동 렌더링 | ✅ 일치 |
| **이미지 업로드** | `createImageUpload`, `UpdatedImage` | 커스텀 구현 (`/api/upload`) | ⚠️ 차이 |
| **이미지 붙여넣기** | `handleImagePaste` | 커스텀 이벤트 리스너 | ⚠️ 차이 |
| **이미지 드롭** | `handleImageDrop` | 커스텀 이벤트 리스너 | ⚠️ 차이 |
| **BubbleMenu** | `EditorBubbleMenu` (Novel) | 커스텀 구현 (Portal) | ⚠️ 차이 |
| **SSR 설정** | `immediatelyRender={false}` | ✅ 설정됨 | ✅ 일치 |
| **키보드 네비게이션** | `handleCommandNavigation` | ✅ 연결됨 | ✅ 일치 |
| **onCommand 형식** | `({ editor, range }) => ...` | ✅ 구조 분해 할당 | ✅ 일치 |

### 3.2 주요 차이점

**1. 이미지 업로드 방식**
- **가이드**: Novel.sh의 `createImageUpload`, `UpdatedImage`, `UploadImagesPlugin` 사용
- **EventLive**: 커스텀 이미지 업로드 로직 (`/api/upload` 엔드포인트 사용)
- **영향**: 기능은 동작하지만 Novel.sh 표준 방식과 다름

**2. 이미지 붙여넣기/드롭**
- **가이드**: Novel.sh의 `handleImagePaste`, `handleImageDrop` 사용
- **EventLive**: 커스텀 이벤트 리스너 (`addEventListener`)
- **영향**: 기능은 동작하지만 Novel.sh 표준 방식과 다름

**3. BubbleMenu 구현**
- **가이드**: Novel.sh의 `EditorBubbleMenu` 컴포넌트 사용
- **EventLive**: 커스텀 구현 (React Portal 사용)
- **영향**: 기능은 동작하지만 Novel.sh 표준 방식과 다름

**4. 확장 패키지**
- **가이드**: `@tiptap/extension-color`, `@tiptap/extension-text-style`, `@tiptap/extension-highlight` 권장
- **EventLive**: 미설치
- **영향**: 텍스트 색상, 하이라이트 기능 없음

---

## 4. 차이점 및 개선 사항

### 4.1 가이드 권장 방식으로 개선 가능한 부분

#### 4.1.1 이미지 업로드 표준화

**현재 구현** (`BlogEditor.tsx`):
```typescript
// 커스텀 이미지 업로드 로직
const handleImageUpload = useCallback(async (file: File) => {
  const formData = new FormData()
  formData.append('file', file)
  const response = await fetch('/api/upload', { ... })
  // ...
}, [editor])
```

**가이드 권장 방식**:
```typescript
import { createImageUpload, UpdatedImage, UploadImagesPlugin } from 'novel'

const imageUploadFn = createImageUpload({
  validateFn: (file: File) => { ... },
  onUpload: async (file: File) => { ... },
})

const imageExtension = UpdatedImage.extend({
  addProseMirrorPlugins() {
    return [
      UploadImagesPlugin({
        imageClass: 'opacity-40 rounded-lg border border-gray-300',
      }),
    ]
  },
}).configure({ ... })
```

**개선 효과**:
- ✅ Novel.sh 표준 방식 준수
- ✅ 업로드 중 상태 표시 자동 처리
- ✅ 에러 처리 표준화
- ✅ 코드 일관성 향상

#### 4.1.2 이미지 붙여넣기/드롭 표준화

**현재 구현**:
```typescript
// 커스텀 이벤트 리스너
useEffect(() => {
  const handlePaste = (e: ClipboardEvent) => { ... }
  const handleDrop = (e: DragEvent) => { ... }
  editorElement.addEventListener('paste', handlePaste)
  editorElement.addEventListener('drop', handleDrop)
}, [editor])
```

**가이드 권장 방식**:
```typescript
import { handleImagePaste, handleImageDrop } from 'novel'

editorProps={{
  handlePaste: (view, event) => {
    const handled = handleImagePaste(view, event, imageUploadFn)
    if (handled) return true
    // ...
  },
  handleDrop: (view, event, slice, moved) => {
    return handleImageDrop(view, event, moved, imageUploadFn)
  },
}}
```

**개선 효과**:
- ✅ Novel.sh 표준 방식 준수
- ✅ 에디터 props 통합 관리
- ✅ 코드 간결성 향상

#### 4.1.3 BubbleMenu 표준화

**현재 구현**:
```typescript
// 커스텀 Portal 구현
export function BubbleMenu({ editor }: BubbleMenuProps) {
  const [isVisible, setIsVisible] = useState(false)
  const [position, setPosition] = useState({ x: 0, y: 0 })
  // 수동 위치 계산 및 Portal 렌더링
}
```

**가이드 권장 방식**:
```typescript
import { EditorBubbleMenu, useEditor } from 'novel'

export function BubbleMenu() {
  const { editor } = useEditor()
  return (
    <EditorBubbleMenu
      editor={editor}
      tippyOptions={{ placement: 'top' }}
      className="..."
    >
      {/* 버튼들 */}
    </EditorBubbleMenu>
  )
}
```

**개선 효과**:
- ✅ Novel.sh 표준 방식 준수
- ✅ 위치 계산 자동 처리
- ✅ 코드 간결성 향상

#### 4.1.4 확장 패키지 추가

**추가 권장 패키지**:
```bash
npm install @tiptap/extension-color @tiptap/extension-text-style @tiptap/extension-highlight
```

**추가 효과**:
- ✅ 텍스트 색상 변경 기능
- ✅ 텍스트 하이라이트 기능
- ✅ 가이드와 기능 일치

### 4.2 현재 구현이 더 나은 부분

**1. 커스텀 확장**
- `SimpleImage`: NodeView 없이 작동하는 이미지 확장
- `StructuredSection`: 구조화된 섹션 확장
- `InfoItem`: 정보 아이템 확장
- `AutoLink`: 자동 링크 확장
- `Small`: 작은 텍스트 확장

**2. 다크모드 지원**
- Tailwind의 `dark:` 클래스 활용
- BubbleMenu, 슬래시 메뉴 등에 다크모드 스타일 적용

**3. 썸네일 자동 설정**
- 첫 번째 이미지를 자동으로 썸네일로 설정하는 기능 (`onSetThumbnail`)

---

## 5. 이식 전략

### 5.1 단계별 이식 계획

#### Phase 1: 필수 패키지 설치 (낮은 위험도)
```bash
npm install @tiptap/extension-color @tiptap/extension-text-style @tiptap/extension-highlight
```

**예상 소요 시간**: 5분  
**위험도**: 낮음 (기존 기능에 영향 없음)

#### Phase 2: 확장 설정 개선 (중간 위험도)
- `extensions.tsx`에 Color, TextStyle, Highlight 확장 추가
- 슬래시 메뉴에 색상/하이라이트 옵션 추가

**예상 소요 시간**: 30분  
**위험도**: 중간 (기존 확장과 충돌 가능성)

#### Phase 3: 이미지 업로드 표준화 (높은 위험도)
- `createImageUpload`, `UpdatedImage`, `UploadImagesPlugin` 도입
- 기존 커스텀 이미지 업로드 로직 대체

**예상 소요 시간**: 2-3시간  
**위험도**: 높음 (기존 이미지 업로드 기능 영향)

#### Phase 4: 이미지 붙여넣기/드롭 표준화 (높은 위험도)
- `handleImagePaste`, `handleImageDrop` 도입
- 기존 커스텀 이벤트 리스너 대체

**예상 소요 시간**: 1-2시간  
**위험도**: 높음 (기존 이미지 붙여넣기/드롭 기능 영향)

#### Phase 5: BubbleMenu 표준화 (중간 위험도)
- `EditorBubbleMenu` 컴포넌트 사용
- 기존 커스텀 Portal 구현 대체

**예상 소요 시간**: 1시간  
**위험도**: 중간 (UI 변경 가능성)

### 5.2 점진적 이식 전략 (권장)

**전략**: 기존 기능을 유지하면서 가이드 권장 방식으로 점진적 개선

1. **Phase 1-2 먼저 실행**: 낮은 위험도 작업부터 진행
2. **Phase 3-5는 선택적**: 기존 기능이 잘 동작하면 유지, 문제 발생 시 개선
3. **테스트 강화**: 각 Phase마다 충분한 테스트 수행

---

## 6. 권장 사항

### 6.1 즉시 적용 가능한 개선 사항

#### ✅ 1. 확장 패키지 추가
```bash
npm install @tiptap/extension-color @tiptap/extension-text-style @tiptap/extension-highlight
```

**이유**: 기능 추가만 하므로 기존 코드에 영향 없음

#### ✅ 2. 가이드의 시행착오 체크리스트 확인
- [x] `renderItems` import 확인 → ✅ 이미 구현됨
- [x] `createSlashCommand`에서 `render: renderItems` 설정 확인 → ✅ 이미 구현됨
- [x] `extensions` 배열에 `slashCommand` 포함 확인 → ✅ 이미 구현됨
- [x] `immediatelyRender={false}` 설정 확인 → ✅ 이미 구현됨
- [x] `handleCommandNavigation` 연결 확인 → ✅ 이미 구현됨
- [x] `onCommand={({ editor, range }) => ...}` 형식 확인 → ✅ 이미 구현됨
- [x] `StarterKit`에서 `link: false` 설정 확인 → ✅ 이미 구현됨

### 6.2 선택적 개선 사항

#### ⚠️ 1. 이미지 업로드 표준화
**장점**:
- Novel.sh 표준 방식 준수
- 업로드 중 상태 표시 자동 처리
- 코드 일관성 향상

**단점**:
- 기존 커스텀 로직 대체 필요
- 테스트 필요
- 잠재적 버그 가능성

**권장**: 기존 기능이 잘 동작하면 유지, 문제 발생 시 개선

#### ⚠️ 2. 이미지 붙여넣기/드롭 표준화
**장점**:
- Novel.sh 표준 방식 준수
- 에디터 props 통합 관리
- 코드 간결성 향상

**단점**:
- 기존 커스텀 로직 대체 필요
- 테스트 필요
- 잠재적 버그 가능성

**권장**: 기존 기능이 잘 동작하면 유지, 문제 발생 시 개선

#### ⚠️ 3. BubbleMenu 표준화
**장점**:
- Novel.sh 표준 방식 준수
- 위치 계산 자동 처리
- 코드 간결성 향상

**단점**:
- UI 변경 가능성
- 기존 커스텀 기능 손실 가능성 (예: 링크 입력 기능)

**권장**: 현재 BubbleMenu가 잘 동작하고 링크 입력 기능이 필요하면 유지

### 6.3 가이드 문서 활용 방안

#### ✅ 1. 트러블슈팅 가이드로 활용
- 가이드의 "시행착오 및 해결 방법" 섹션을 참고하여 문제 해결
- "트러블슈팅" 섹션을 참고하여 일반적인 문제 해결

#### ✅ 2. 신규 기능 추가 시 참고
- 새로운 기능 추가 시 가이드의 패턴 참고
- 예: 라이트박스 모달 추가 시 가이드의 `PostViewer.tsx` 참고

#### ✅ 3. 코드 리뷰 체크리스트로 활용
- 가이드의 "체크리스트" 섹션을 코드 리뷰 시 사용
- 새로운 에디터 컴포넌트 추가 시 가이드 패턴 준수

---

## 7. 결론

### 7.1 현재 상태 평가

**✅ 잘 구현된 부분**:
- 슬래시 메뉴 구현 (가이드 권장 방식 준수)
- SSR 설정 (`immediatelyRender={false}`)
- 키보드 네비게이션 (`handleCommandNavigation`)
- `onCommand` 형식 (구조 분해 할당)
- 기본 편집 기능

**⚠️ 개선 가능한 부분**:
- 이미지 업로드 방식 (커스텀 → Novel.sh 표준)
- 이미지 붙여넣기/드롭 (커스텀 → Novel.sh 표준)
- BubbleMenu (커스텀 → Novel.sh 표준)
- 확장 패키지 추가 (Color, TextStyle, Highlight)

### 7.2 최종 권장 사항

1. **즉시 적용**: 확장 패키지 추가 (`@tiptap/extension-color`, `@tiptap/extension-text-style`, `@tiptap/extension-highlight`)
2. **선택적 적용**: 이미지 업로드/붙여넣기/드롭 표준화 (기존 기능 문제 발생 시)
3. **유지 권장**: 현재 BubbleMenu (링크 입력 기능 포함)
4. **참고 자료**: 가이드를 트러블슈팅 가이드 및 신규 기능 추가 시 참고 자료로 활용

### 7.3 이식 난이도 평가

**전체 평가**: ⭐⭐⭐☆☆ (중간 난이도)

- **기술적 난이도**: 낮음 (이미 대부분 구현됨)
- **위험도**: 중간 (기존 기능 대체 필요)
- **소요 시간**: 1-2일 (선택적 개선 포함)

---

**작성 완료**: 2026-01-28  
**버전**: 1.0  
**작성자**: AI Assistant  
**검토 상태**: ✅ EventLive 프로젝트 기준 검토 완료
