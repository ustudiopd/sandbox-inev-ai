# 현재 작업 상황 (Active Context)

## 1. 현재 집중하고 있는 작업  
- **작업명**: 게스트 접속 및 UI/UX 개선 완료
- **목표**: 
  - 게스트 접속 기능 구현
  - 웨비나별 독립 세션 관리
  - 메인 페이지 및 관리자 페이지 UI 개선
  - 모바일 반응형 사이드바
- **상태**: ✅ 완료
  - 게스트 계정 생성 API 및 UI 구현
  - 웨비나별 독립 회원가입/등록 시스템
  - 회원가입 시 닉네임 선택 기능
  - 메인 페이지 UI 개선 (웨비나 목록, 접근 정책 안내)
  - 관리자 접속 페이지 생성 (`/admin`)
  - 사이드바 모바일 반응형 (하단 메뉴)
  - 로그아웃 기능 개선
  - 웨비나 제목 클릭 기능

## 2. 다음 예정 작업  
- **우선순위 높음**: 
  1. 설문조사 기능 구현 (새로 요청됨)
     - 설문조사 생성/관리 (운영 콘솔)
     - 설문조사 응답 (참여자)
     - 설문조사 결과 조회/통계
  2. 발표자료 다운로드 기능 구현 (새로 요청됨)
     - 파일 업로드 (웨비나 생성/수정 시)
     - 파일 다운로드 (참여자)
     - 파일 관리 (운영 콘솔)
  3. 퀴즈 기능 구현
  4. 추첨 기능 구현

- **우선순위 중간**:
  5. 웨비나 등록 페이지
  6. 초대 링크 처리 (`/invite/[token]`)

- **우선순위 낮음**:
  7. 리포트 고도화
  8. Typing 표시 기능 완성

## 3. 주요 이슈 및 블로커  
- 현재 개발을 진행하는 데 방해가 되는 요소 없음
- 설문조사 및 발표자료 다운로드 기능에 대한 상세 요구사항 검토 필요

## 4. 최근 해결된 이슈
- ✅ PresenceBar 중복 사용자 표시 문제 해결 (Map 기반 중복 제거)
- ✅ RLS 무한 재귀 문제 해결 (Admin Supabase 사용)
- ✅ Next.js 15 호환성 문제 해결 (params, cookies await 처리)
- ✅ 4K 모니터 레이아웃 문제 해결
- ✅ 채팅 메시지 "익명" 표시 문제 해결 (프로필 RLS 정책 추가, API 엔드포인트 생성)
- ✅ Supabase Realtime 구독 오류 해결 (Realtime 활성화 마이그레이션 적용)
- ✅ 서버-클라이언트 바인딩 불일치 오류 해결 (고유한 채널 이름 생성)
- ✅ Optimistic Update에서 프로필 이름 즉시 표시 (프로필 정보 사전 로드)
- ✅ 크롬에서 "전송 중..." 고착 문제 해결 (`client_msg_id` 기반 정확한 매칭, API 즉시 교체)
- ✅ Realtime 연결 안정성 향상 (토큰 주입, 폴백 폴링, 자동 재연결)
- ✅ 웨비나 페이지 모바일 레이아웃 문제 해결 (마진 제거, 전체 너비 사용)
- ✅ 관리자 모드 구현 (채팅/질문 관리 기능)
- ✅ Q&A 답변 기능 개선 (답변 내용 저장, 기본 펼침)
- ✅ 답변 모달 닫기 방지 (답변 중일 때)
- ✅ 게스트 계정 세션 설정 문제 해결 (`signInWithPassword` 사용)
- ✅ 메시지 조회 API 인증 오류 해결 (Route Handler 호환성 개선)
- ✅ 웨비나별 등록 확인 강제 (모든 모드에서 등록 확인)
- ✅ 웨비나 시간대 변환 문제 해결 (UTC ↔ 로컬 시간 변환)

## 5. 현재 시스템 상태
- **데이터베이스**: Supabase PostgreSQL (RLS 활성화)
- **인증**: Supabase Auth
- **실시간**: Supabase Realtime 활성화됨 (messages, questions, quizzes, quiz_responses, draws, winners, reactions 테이블)
- **스토리지**: Supabase Storage (아직 미사용, 발표자료 다운로드에 필요)
- **배포**: Vercel (로컬 개발 중)
- **최근 마이그레이션**: Realtime 활성화 (`enable_realtime_for_messages`)
